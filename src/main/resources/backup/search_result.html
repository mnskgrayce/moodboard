<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search Result</title>
    <link rel="stylesheet" href="../../Bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="../Bootstrap/MDB5-STANDARD-UI-KIT-Free-3.5.1/css/mdb.dark.min.css"
    />
    <script
      type="text/javascript"
      src="../Bootstrap/MDB5-STANDARD-UI-KIT-Free-3.5.1/js/mdb.min.js"
    ></script>
    <style>
      .row {
        margin: 20;
        scale: 90%;
      }
      img {
        width: 300px;
        height: 250px;
      }
    </style>
    <script>
      window.onload = function () {
        var url = document.location.href,
          params = url.split("?")[1].split("&"),
          data = {},
          tmp;
        for (var i = 0, l = params.length; i < l; i++) {
          tmp = params[i].split("=");
          data[tmp[0]] = tmp[1];
        }

        fetch_search_request(data.search);
      };
      window.onload = function () {
        var url = document.location.href,
          params = url.split("?")[1].split("&"),
          data = {},
          tmp;
        for (var i = 0, l = params.length; i < l; i++) {
          tmp = params[i].split("=");
          data[tmp[0]] = tmp[1];
        }

        fetch_search_request(data.search);
      };

      function fetch_search_request(query) {
        var access_key = "ciSDJprk_BRsXoaM0uQC8d5y5_bv2ekXCZv6QxquHLU";
        var unsplash_API = "https://api.unsplash.com/";
        var request =
          unsplash_API +
          "search/photos?query=" +
          query +
          "&client_id=" +
          access_key;
        var query_limit = 8;
        console.log(request);
        document.getElementById("result").innerHTML += query;

        fetch(request)
          .then((response) => response.json())
          .then((json) => {
            for (
              let index = 0;
              index < json.results.length && index < query_limit;
              index++
            ) {
              var result = json.results[index];
              var adj_html =
                `<img src="${result.urls.regular}" class="w-100" id="${result.id}" onClick="open_post(this.id)">` +
                "<br/>";

              document
                .getElementById(`frame_${index + 1}`)
                .insertAdjacentHTML("afterend", adj_html);
            }
          });
      }

      // Open new post on clicked image
      function open_post(image_id) {
        document.location.href = url =
          "post.html?id=" + encodeURIComponent(image_id);
      }
    </script>
  </head>
  <body>
    <!-- Carousel wrapper -->
    <!-- Navbar -->
    <nav
      class="navbar navbar-expand-lg navbar-dark d-none d-lg-block"
      style="z-index: 2000"
    >
      <div class="container-fluid">
        <!-- Navbar brand -->
        <img
          style="height: 30px; width: 30px"
          src="../Bootstrap/MDB5-STANDARD-UI-KIT-Free-3.5.1/img/icon.png"
          alt="icon"
        />
        <a class="navbar-brand nav-link" target="_blank" href="Menu2.html">
          <strong>My Picture</strong>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-mdb-toggle="collapse"
          data-mdb-target="#navbarExample01"
          aria-controls="navbarExample01"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarExample01">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item active">
              <a class="nav-link" aria-current="page" href="#intro">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="login.html"
                >Sign in</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="register.html"
                >Register</a
              >
            </li>
            <li class="nav-item">
              <form
                action="search_result.html"
                class="form-inline my-2 my-lg-0"
              >
                <input
                  class="form-control mr-sm-2"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                  name="search"
                />
              </form>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="" rel="nofollow" target="_blank"></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="" target="_blank"></a>
            </li>
          </ul>

          <ul class="navbar-nav list-inline">
            <!-- Icons -->
            <li class="">
              <a class="nav-link" href="" rel="nofollow" target="_blank">
                <i class="fab fa-youtube"></i>
              </a>
            </li>
            <li class="">
              <a
                class="nav-link"
                href="https://www.facebook.com/mdbootstrap"
                rel="nofollow"
                target="_blank"
              >
                <i class="fab fa-facebook-f"></i>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://twitter.com/MDBootstrap"
                rel="nofollow"
                target="_blank"
              >
                <i class="fab fa-twitter"></i>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://github.com/mdbootstrap/mdb-ui-kit"
                rel="nofollow"
                target="_blank"
              >
                <i class="fab fa-github"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Navbar -->

    <h4 id="result">Displaying search result for:</h4>
    <div class="row" id="gallery">
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_1"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_2"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_3"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_4"></div>
      </div>
    </div>
    <br />
    <div class="row" id="">
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_5"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_6"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_7"></div>
      </div>
      <div class="col-12 col-sm-6 col-lg-3">
        <div id="frame_8"></div>
      </div>
    </div>
  </body>
</html>
